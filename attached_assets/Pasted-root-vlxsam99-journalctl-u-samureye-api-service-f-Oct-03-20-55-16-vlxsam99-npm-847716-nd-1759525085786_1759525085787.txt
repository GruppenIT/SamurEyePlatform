root@vlxsam99:~# journalctl -u samureye-api.service -f
Oct 03 20:55:16 vlxsam99 npm[847716]: ğŸ” Ãndice Ãºnico de correlation_key: EXISTE
Oct 03 20:55:16 vlxsam99 npm[847716]: âœ… Estrutura do banco de dados jÃ¡ estÃ¡ atualizada
Oct 03 20:55:16 vlxsam99 npm[847716]: ğŸ•’ Iniciando monitor de ameaÃ§as hibernadas...
Oct 03 20:55:16 vlxsam99 npm[847716]: ğŸ•’ Checking for hibernated threats to activate
Oct 03 20:55:16 vlxsam99 npm[847716]: ğŸ“Š Found 0 hibernated threats to activate
Oct 03 20:55:16 vlxsam99 npm[847716]: ğŸ• Iniciando serviÃ§o de agendamento...
Oct 03 20:55:16 vlxsam99 npm[847716]: âœ… ServiÃ§o de agendamento iniciado com sucesso
Oct 03 20:55:16 vlxsam99 npm[847716]: 8:55:16 PM [express] serving on port 5000
Oct 03 20:55:19 vlxsam99 npm[847716]: 8:55:19 PM [express] GET /api/health 200 in 5ms :: {"status":"ok","timestamp":"2025-10-03T20:55:19.9â€¦
Oct 03 20:55:29 vlxsam99 npm[847716]: 8:55:29 PM [express] GET /api/health 200 in 1ms :: {"status":"ok","timestamp":"2025-10-03T20:55:29.9â€¦
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] POST /api/auth/logout 200 in 19ms :: {"message":"Logout realizado com sucesso"}
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] GET /api/auth/user 401 in 1ms :: {"message":"NÃ£o autorizado"}
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] GET /api/auth/user 401 in 0ms :: {"message":"NÃ£o autorizado"}
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] GET /api/threats 401 in 1ms :: {"message":"NÃ£o autorizado"}
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] GET /api/auth/user 401 in 1ms :: {"message":"NÃ£o autorizado"}
Oct 03 20:56:15 vlxsam99 npm[847716]: 8:56:15 PM [express] POST /api/auth/login 200 in 340ms :: {"message":"Login realizado com sucesso","â€¦
Oct 03 20:56:15 vlxsam99 npm[847716]: 8:56:15 PM [express] GET /api/auth/user 200 in 4ms :: {"id":"2dd3181e-41a4-417a-baee-e439ef680459","â€¦
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] POST /api/auth/change-password 200 in 646ms :: {"message":"Senha alterada com sâ€¦
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/auth/user 200 in 3ms :: {"id":"2dd3181e-41a4-417a-baee-e439ef680459","â€¦
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/system/metrics 304 in 11ms :: {"cpu":0,"memory":11,"services":[{"name"â€¦
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/threats 304 in 25ms :: []
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/dashboard/running-jobs 304 in 27ms :: []
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/dashboard/recent-threats 304 in 25ms :: []
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/dashboard/metrics 304 in 32ms :: {"activeAssets":0,"criticalThreats":0â€¦
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/schedules 304 in 23ms :: []
Oct 03 20:56:22 vlxsam99 npm[847716]: 8:56:22 PM [express] GET /api/credentials 200 in 6ms :: []
Oct 03 20:56:35 vlxsam99 npm[847716]: 8:56:35 PM [express] POST /api/credentials 201 in 28ms :: {"id":"94336fcf-0201-438e-b1f5-d8faccb3282â€¦
Oct 03 20:56:35 vlxsam99 npm[847716]: 8:56:35 PM [express] GET /api/credentials 200 in 5ms :: [{"id":"94336fcf-0201-438e-b1f5-d8faccb32827â€¦
Oct 03 20:56:37 vlxsam99 npm[847716]: 8:56:37 PM [express] GET /api/journeys 200 in 5ms :: []
Oct 03 20:56:38 vlxsam99 npm[847716]: 8:56:38 PM [express] GET /api/assets 304 in 4ms :: []
Oct 03 20:56:56 vlxsam99 npm[847716]: 8:56:56 PM [express] POST /api/journeys 201 in 26ms :: {"id":"3664d3b1-86ea-48c8-818b-04bb18cbe79f",â€¦
Oct 03 20:56:56 vlxsam99 npm[847716]: 8:56:56 PM [express] GET /api/journeys 200 in 4ms :: [{"id":"3664d3b1-86ea-48c8-818b-04bb18cbe79f","â€¦
Oct 03 20:56:59 vlxsam99 npm[847716]: 8:56:59 PM [express] POST /api/jobs/execute 201 in 22ms :: {"id":"554102b9-2a44-4f2a-821b-186726e142â€¦
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ  Host de domÃ­nio criado/atualizado: gruppen.com.br
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ  AD Hygiene: Host de domÃ­nio criado: gruppen.com.br
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ” Iniciando anÃ¡lise de seguranÃ§a AD para domÃ­nio gruppen.com.br
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ¯ Usando DC primÃ¡rio: 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”´ Executando testes: ConfiguraÃ§Ãµes CrÃ­ticas...
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Controlador de domÃ­nio com spooler de impressÃ£o ativado (PrintNightmare)]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-Service -Name Spooler | Select-Object Name, Status | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [Controlador de domÃ­nio com spooler de impressÃ£o ativado (PrintNightmare)]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [LDAP anÃ´nimo e sem assinatura permitido]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADObject -Identity 'CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=gruppen,DC=com,DC=br' -Properties dSHeuristics | Select-Object -Property dSHeuristics | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [LDAP anÃ´nimo e sem assinatura permitido]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [SessÃ£o SMBv1 fraca permitida]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-WindowsFeature -Name FS-SMB1 | Select-Object Name, InstallState | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [SessÃ£o SMBv1 fraca permitida]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Conta KRBTGT fraca (Golden Ticket)]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Identity krbtgt -Property PasswordLastSet | Select-Object Name, PasswordLastSet | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [Conta KRBTGT fraca (Golden Ticket)]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [AlteraÃ§Ãµes de permissÃµes padrÃ£o na partiÃ§Ã£o do esquema]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: (Get-Acl 'AD:CN=Schema,CN=Configuration,DC=gruppen,DC=com,DC=br').Access | Where-Object {$_.IdentityReference -notmatch 'SYSTEM|Administrators|Schema Admins|Enterprise Admins'} | Select-Object Identit...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [AlteraÃ§Ãµes de permissÃµes padrÃ£o na partiÃ§Ã£o do esquema]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… ConfiguraÃ§Ãµes CrÃ­ticas: 0 achados
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ‘¥ Executando testes: Gerenciamento de Contas...
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [UsuÃ¡rios privilegiados com Service Principal Names (SPN) definidos]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Filter * -Properties servicePrincipalName, MemberOf | Where-Object {$_.servicePrincipalName -and ($_.MemberOf -match 'Admins')} | Select-Object Name, SamAccountName, servicePrincipalName |...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [UsuÃ¡rios privilegiados com Service Principal Names (SPN) definidos]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas com senha sem expiraÃ§Ã£o]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Filter {PasswordNeverExpires -eq $true} -Property Name, PasswordNeverExpires | Select-Object Name, PasswordNeverExpires | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [Contas com senha sem expiraÃ§Ã£o]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas com prÃ©-autenticaÃ§Ã£o desativada]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Filter * -Properties UserAccountControl | Where-Object {$_.UserAccountControl -band 0x400000} | Select-Object Name, SamAccountName | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [Contas com prÃ©-autenticaÃ§Ã£o desativada]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Conta de administrador padrÃ£o fraca]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Identity 'Administrator' -Property PasswordLastSet, PasswordNeverExpires, LastLogonTimestamp | Select-Object Name, PasswordLastSet, PasswordNeverExpires, @{Name='LastLogon';Expression={[Da...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [Conta de administrador padrÃ£o fraca]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Controladores de domÃ­nio com senha nÃ£o alterada recentemente]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADDomainController -Filter * | ForEach-Object { Get-ADComputer -Identity $_.Name -Property PasswordLastSet | Select-Object Name, PasswordLastSet } | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: âœ… PowerShell [Controladores de domÃ­nio com senha nÃ£o alterada recentemente]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas com ID de grupo primÃ¡rio (PrimaryGroupID) menor que 1000]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Filter {primaryGroupId -lt 1000} -Property primaryGroupId | Select-Object Name, primaryGroupId | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Contas com ID de grupo primÃ¡rio (PrimaryGroupID) menor que 1000]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Atributo AdminCount definido para usuÃ¡rios padrÃ£o]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Filter {admincount -gt 0} -Properties adminCount, MemberOf | Where-Object {-not ($_.MemberOf -match "Admins")} | Select-Object Name, SamAccountName, adminCount | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Atributo AdminCount definido para usuÃ¡rios padrÃ£o]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [RelaÃ§Ãµes de confianÃ§a de alto risco]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADTrust -Filter * | Select-Object Name, TrustType, TrustDirection, ForestTransitive | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [RelaÃ§Ãµes de confianÃ§a de alto risco]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas com SID privilegiado oculto]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Filter {admincount -gt 0} -Properties adminCount, sidHistory | Where-Object {$_.sidHistory} | Select-Object Name, SamAccountName, adminCount, sidHistory | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Contas com SID privilegiado oculto]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas usando controle de acesso compatÃ­vel com prÃ©-Windows 2000]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADGroupMember -Identity 'Pre-Windows 2000 Compatible Access' -Recursive | Select-Object Name, SamAccountName | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Contas usando controle de acesso compatÃ­vel com prÃ©-Windows 2000]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… Gerenciamento de Contas: 0 achados
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ« Executando testes: Kerberos e DelegaÃ§Ã£o...
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Conta KRBTGT com delegaÃ§Ã£o restrita baseada em recursos (RBCD) habilitada]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Identity 'krbtgt' -Property 'msDS-AllowedToDelegateTo' | Select-Object SamAccountName, 'msDS-AllowedToDelegateTo' | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Conta KRBTGT com delegaÃ§Ã£o restrita baseada em recursos (RBCD) habilitada]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [UsuÃ¡rios padrÃ£o com permissÃ£o para leitura de senha de GMSA]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADServiceAccount -Filter * -Properties PrincipalsAllowedToRetrieveManagedPassword | Where-Object {$_.PrincipalsAllowedToRetrieveManagedPassword} | Select-Object Name, PrincipalsAllowedToRetrieveMa...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [UsuÃ¡rios padrÃ£o com permissÃ£o para leitura de senha de GMSA]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [AvaliaÃ§Ã£o de vulnerabilidades do Kerberos]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Filter * -Properties 'msDS-SupportedEncryptionTypes' | Where-Object {$_.'msDS-SupportedEncryptionTypes' -lt 16} | Select-Object Name, SamAccountName, 'msDS-SupportedEncryptionTypes' | Conv...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [AvaliaÃ§Ã£o de vulnerabilidades do Kerberos]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Comprometimento de conta de computador via delegaÃ§Ã£o restrita baseada em recursos do Kerberos (RBCD)]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADComputer -Filter * -Properties PrincipalsAllowedToDelegateToAccount | Where-Object {$_.PrincipalsAllowedToDelegateToAccount} | Select-Object Name, SamAccountName, PrincipalsAllowedToDelegateToAc...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Comprometimento de conta de computador via delegaÃ§Ã£o restrita baseada em recursos do Kerberos (RBCD)]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Direitos de acesso perigosos na conta KDC do RODC]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADDomainController -Filter {IsReadOnly -eq $true} | ForEach-Object { Get-ADComputer -Identity $_.Name -Properties 'msDS-RevealedUsers' | Select-Object Name, 'msDS-RevealedUsers' } | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Direitos de acesso perigosos na conta KDC do RODC]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… Kerberos e DelegaÃ§Ã£o: 0 achados
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“‚ Executando testes: Compartilhamentos e GPOs...
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Coleta de credenciais a partir de compartilhamentos de domÃ­nio]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: $paths = @('\\gruppen.com.br\SYSVOL', '\\gruppen.com.br\NETLOGON'); foreach ($path in $paths) { Get-ChildItem -Path $path -Recurse -Include *.ps1, *.vbs, *.bat, *.xml -ErrorAction SilentlyContinue | S...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Coleta de credenciais a partir de compartilhamentos de domÃ­nio]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Verificar objetos GPO sensÃ­veis e permissÃµes de arquivos]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: $path = '\\gruppen.com.br\SYSVOL'; $acl = Get-Acl -Path $path; $acl.Access | Where-Object {$_.IdentityReference -notmatch 'Domain Admins|Enterprise Admins|SYSTEM|Administrators|Authenticated Users|Ser...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Verificar objetos GPO sensÃ­veis e permissÃµes de arquivos]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Assinatura SMB fraca]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-SmbServerConfiguration | Select-Object RequireSecuritySignature, EnableSecuritySignature | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Assinatura SMB fraca]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… Compartilhamentos e GPOs: 0 achados
Oct 03 20:57:00 vlxsam99 npm[847716]: âš™ï¸  Executando testes: PolÃ­ticas e ConfiguraÃ§Ã£o...
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas com parÃ¢metros de controle de conta de usuÃ¡rio arriscados]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Filter * -Property userAccountControl | Where-Object {($_.userAccountControl -band 0x10000) -or ($_.userAccountControl -band 0x80000)} | Select-Object Name, userAccountControl | ConvertTo-...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [Contas com parÃ¢metros de controle de conta de usuÃ¡rio arriscados]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [DomÃ­nios com nÃ­vel funcional desatualizado]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADDomain | Select-Object DomainMode, DistinguishedName | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [DomÃ­nios com nÃ­vel funcional desatualizado]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [SoluÃ§Ã£o LAPS nÃ£o habilitada]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADComputer -Filter * -Properties 'ms-Mcs-AdmPwd' -ResultSetSize 100 | Where-Object {$_.'ms-Mcs-AdmPwd' -eq $null} | Measure-Object | Select-Object Count | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: âœ… PowerShell [SoluÃ§Ã£o LAPS nÃ£o habilitada]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas de usuÃ¡rio padrÃ£o como administradores DNS]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADGroupMember -Identity 'DnsAdmins' -Recursive | Where-Object {$_.objectClass -eq 'user'} | Select-Object Name, SamAccountName | ConvertTo-Json...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [Contas de usuÃ¡rio padrÃ£o como administradores DNS]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [ACE nÃ£o canÃ´nico em objetos]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $objects = Get-ADObject -Filter * -Properties nTSecurityDescriptor -ResultSetSize 1000; $nonCanonical = $objects | Where-Object {$_.nTSecurityDescriptor.AreAccessRulesCanonical -eq $false}; $nonCanoni...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [ACE nÃ£o canÃ´nico em objetos]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas krbtgt de RODC Ã³rfÃ£s]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: Get-ADObject -Filter {(objectclass -eq 'user') -and (name -like 'krbtgt*')} -Properties 'msDS-KrbTgtLinkBl' | Where-Object {-not $_.'msDS-KrbTgtLinkBl'} | Select-Object Name, 'msDS-KrbTgtLinkBl' | Con...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [Contas krbtgt de RODC Ã³rfÃ£s]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [DomÃ­nio com configuraÃ§Ã£o de compatibilidade retroativa perigosa]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: Get-ADObject -Identity 'CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=gruppen,DC=com,DC=br' -Properties dSHeuristics | Where-Object {$_.dSHeuristics} | Select-Object -ExpandProper...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [DomÃ­nio com configuraÃ§Ã£o de compatibilidade retroativa perigosa]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PolÃ­ticas e ConfiguraÃ§Ã£o: 0 achados
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ’¤ Executando testes: Contas Inativas...
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas privilegiadas inativas]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $DaysInactive = 90; $InactiveDate = (Get-Date).AddDays(-$DaysInactive); Get-ADUser -Filter {Enabled -eq $True} -Properties LastLogonDate, MemberOf | Where-Object {($_.LastLogonDate -lt $InactiveDate) ...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [Contas privilegiadas inativas]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas desativadas em grupos privilegiados]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: Get-ADUser -Filter {Enabled -eq $false} -Properties MemberOf | Where-Object {$_.MemberOf -match 'Admins'} | Select-Object Name, SamAccountName | ConvertTo-Json...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [Contas desativadas em grupos privilegiados]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas gMSA com senha nÃ£o alterada recentemente]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $DaysThreshold = 90; $ThresholdDate = (Get-Date).AddDays(-$DaysThreshold); Get-ADServiceAccount -Filter * -Properties whenChanged | Where-Object {$_.whenChanged -lt $ThresholdDate} | Select-Object Nam...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [Contas gMSA com senha nÃ£o alterada recentemente]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas de serviÃ§o inativas hÃ¡ mais de 60 dias]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $daysInactive = 60; $limitDate = (Get-Date).AddDays(-$daysInactive); Get-ADUser -Filter {(servicePrincipalName -like '*') -and (LastLogonDate -lt $limitDate)} -Properties LastLogonDate, servicePrincip...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [Contas de serviÃ§o inativas hÃ¡ mais de 60 dias]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Servidores com senhas nÃ£o alteradas hÃ¡ mais de 60 dias]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $days = 60; $limitDate = (Get-Date).AddDays(-$days); Get-ADComputer -Filter {OperatingSystem -like '*Windows Server*'} -Properties PasswordLastSet | Where-Object {$_.PasswordLastSet -lt $limitDate} | ...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [Servidores com senhas nÃ£o alteradas hÃ¡ mais de 60 dias]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”§ PowerShell [Contas de usuÃ¡rio dormentes]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“ Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $days = 90; $date = (Get-Date).AddDays(-$days); Get-ADUser -Filter {(Enabled -eq $true) -and (LastLogonDate -lt $date)} -Properties LastLogonDate -ResultSetSize 100 | Select-Object Name, LastLogonDate...
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… PowerShell [Contas de usuÃ¡rio dormentes]: ConcluÃ­do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… Contas Inativas: 0 achados
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… AnÃ¡lise concluÃ­da: 0 achados, 28 resultados de teste
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… Salvos 28 resultados de testes AD Security
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ” PROCESS_JOB_RESULTS: Starting with jobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ” PROCESS_JOB_RESULTS: Journey 3664d3b1-86ea-48c8-818b-04bb18cbe79f, Type: ad_security, JobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ” ThreatEngine.analyzeWithLifecycle: Analisando 0 findings para journeyType 'ad_security' (jobId: 554102b9-2a44-4f2a-821b-186726e14258)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ¯ ThreatEngine.analyzeWithLifecycle: Criou 0 ameaÃ§as de 0 findings para journeyType 'ad_security'
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ” PROCESS_JOB_RESULTS: About to run post-processing with jobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ” AD_SECURITY_CLOSURES: Starting with journeyId: 3664d3b1-86ea-48c8-818b-04bb18cbe79f, jobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ“Š AD_SECURITY_METRICS: Starting analysis - observedKeys: 0, openThreats: 0, currentJobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: âœ… AD_SECURITY_METRICS: Completed - skippedCurrentJob: 0, closed: 0, keptOpen: 0, noCorrelationKey: 0, total: 0
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ”„ Processing journey completion for job 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ†• CLOSURE_METRICS: First-run detected for journey 3664d3b1-86ea-48c8-818b-04bb18cbe79f - skipping auto-closure (previousJobsCount: 0, currentJobId: 554102b9-2a44-4f2a-821b-186726e14258)
Oct 03 20:57:01 vlxsam99 npm[847716]: ğŸ—‘ï¸  Job 554102b9-2a44-4f2a-821b-186726e14258 removido dos jobs em execuÃ§Ã£o
Oct 03 20:57:12 vlxsam99 npm[847716]: 8:57:12 PM [express] GET /api/hosts 200 in 29ms :: [{"id":"f42626ab-42fc-4e99-aae6-463750535e9d","naâ€¦
Oct 03 20:57:14 vlxsam99 npm[847716]: 8:57:14 PM [express] GET /api/threats 200 in 6ms :: []
Oct 03 20:57:14 vlxsam99 npm[847716]: 8:57:14 PM [express] GET /api/hosts/f42626ab-42fc-4e99-aae6-463750535e9d/risk-history 200 in 7ms :: â€¦
Oct 03 20:57:14 vlxsam99 npm[847716]: 8:57:14 PM [express] GET /api/hosts/f42626ab-42fc-4e99-aae6-463750535e9d/ad-tests 200 in 20ms :: [{"â€¦
