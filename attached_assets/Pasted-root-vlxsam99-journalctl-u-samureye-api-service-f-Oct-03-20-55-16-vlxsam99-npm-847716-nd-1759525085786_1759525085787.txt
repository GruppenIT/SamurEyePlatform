root@vlxsam99:~# journalctl -u samureye-api.service -f
Oct 03 20:55:16 vlxsam99 npm[847716]: üîç √çndice √∫nico de correlation_key: EXISTE
Oct 03 20:55:16 vlxsam99 npm[847716]: ‚úÖ Estrutura do banco de dados j√° est√° atualizada
Oct 03 20:55:16 vlxsam99 npm[847716]: üïí Iniciando monitor de amea√ßas hibernadas...
Oct 03 20:55:16 vlxsam99 npm[847716]: üïí Checking for hibernated threats to activate
Oct 03 20:55:16 vlxsam99 npm[847716]: üìä Found 0 hibernated threats to activate
Oct 03 20:55:16 vlxsam99 npm[847716]: üïê Iniciando servi√ßo de agendamento...
Oct 03 20:55:16 vlxsam99 npm[847716]: ‚úÖ Servi√ßo de agendamento iniciado com sucesso
Oct 03 20:55:16 vlxsam99 npm[847716]: 8:55:16 PM [express] serving on port 5000
Oct 03 20:55:19 vlxsam99 npm[847716]: 8:55:19 PM [express] GET /api/health 200 in 5ms :: {"status":"ok","timestamp":"2025-10-03T20:55:19.9‚Ä¶
Oct 03 20:55:29 vlxsam99 npm[847716]: 8:55:29 PM [express] GET /api/health 200 in 1ms :: {"status":"ok","timestamp":"2025-10-03T20:55:29.9‚Ä¶
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] POST /api/auth/logout 200 in 19ms :: {"message":"Logout realizado com sucesso"}
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] GET /api/auth/user 401 in 1ms :: {"message":"N√£o autorizado"}
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] GET /api/auth/user 401 in 0ms :: {"message":"N√£o autorizado"}
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] GET /api/threats 401 in 1ms :: {"message":"N√£o autorizado"}
Oct 03 20:56:10 vlxsam99 npm[847716]: 8:56:10 PM [express] GET /api/auth/user 401 in 1ms :: {"message":"N√£o autorizado"}
Oct 03 20:56:15 vlxsam99 npm[847716]: 8:56:15 PM [express] POST /api/auth/login 200 in 340ms :: {"message":"Login realizado com sucesso","‚Ä¶
Oct 03 20:56:15 vlxsam99 npm[847716]: 8:56:15 PM [express] GET /api/auth/user 200 in 4ms :: {"id":"2dd3181e-41a4-417a-baee-e439ef680459","‚Ä¶
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] POST /api/auth/change-password 200 in 646ms :: {"message":"Senha alterada com s‚Ä¶
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/auth/user 200 in 3ms :: {"id":"2dd3181e-41a4-417a-baee-e439ef680459","‚Ä¶
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/system/metrics 304 in 11ms :: {"cpu":0,"memory":11,"services":[{"name"‚Ä¶
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/threats 304 in 25ms :: []
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/dashboard/running-jobs 304 in 27ms :: []
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/dashboard/recent-threats 304 in 25ms :: []
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/dashboard/metrics 304 in 32ms :: {"activeAssets":0,"criticalThreats":0‚Ä¶
Oct 03 20:56:20 vlxsam99 npm[847716]: 8:56:20 PM [express] GET /api/schedules 304 in 23ms :: []
Oct 03 20:56:22 vlxsam99 npm[847716]: 8:56:22 PM [express] GET /api/credentials 200 in 6ms :: []
Oct 03 20:56:35 vlxsam99 npm[847716]: 8:56:35 PM [express] POST /api/credentials 201 in 28ms :: {"id":"94336fcf-0201-438e-b1f5-d8faccb3282‚Ä¶
Oct 03 20:56:35 vlxsam99 npm[847716]: 8:56:35 PM [express] GET /api/credentials 200 in 5ms :: [{"id":"94336fcf-0201-438e-b1f5-d8faccb32827‚Ä¶
Oct 03 20:56:37 vlxsam99 npm[847716]: 8:56:37 PM [express] GET /api/journeys 200 in 5ms :: []
Oct 03 20:56:38 vlxsam99 npm[847716]: 8:56:38 PM [express] GET /api/assets 304 in 4ms :: []
Oct 03 20:56:56 vlxsam99 npm[847716]: 8:56:56 PM [express] POST /api/journeys 201 in 26ms :: {"id":"3664d3b1-86ea-48c8-818b-04bb18cbe79f",‚Ä¶
Oct 03 20:56:56 vlxsam99 npm[847716]: 8:56:56 PM [express] GET /api/journeys 200 in 4ms :: [{"id":"3664d3b1-86ea-48c8-818b-04bb18cbe79f","‚Ä¶
Oct 03 20:56:59 vlxsam99 npm[847716]: 8:56:59 PM [express] POST /api/jobs/execute 201 in 22ms :: {"id":"554102b9-2a44-4f2a-821b-186726e142‚Ä¶
Oct 03 20:56:59 vlxsam99 npm[847716]: üè† Host de dom√≠nio criado/atualizado: gruppen.com.br
Oct 03 20:56:59 vlxsam99 npm[847716]: üè† AD Hygiene: Host de dom√≠nio criado: gruppen.com.br
Oct 03 20:56:59 vlxsam99 npm[847716]: üîç Iniciando an√°lise de seguran√ßa AD para dom√≠nio gruppen.com.br
Oct 03 20:56:59 vlxsam99 npm[847716]: üéØ Usando DC prim√°rio: 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üî¥ Executando testes: Configura√ß√µes Cr√≠ticas...
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Controlador de dom√≠nio com spooler de impress√£o ativado (PrintNightmare)]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-Service -Name Spooler | Select-Object Name, Status | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Controlador de dom√≠nio com spooler de impress√£o ativado (PrintNightmare)]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [LDAP an√¥nimo e sem assinatura permitido]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADObject -Identity 'CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=gruppen,DC=com,DC=br' -Properties dSHeuristics | Select-Object -Property dSHeuristics | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [LDAP an√¥nimo e sem assinatura permitido]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Sess√£o SMBv1 fraca permitida]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-WindowsFeature -Name FS-SMB1 | Select-Object Name, InstallState | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Sess√£o SMBv1 fraca permitida]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Conta KRBTGT fraca (Golden Ticket)]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Identity krbtgt -Property PasswordLastSet | Select-Object Name, PasswordLastSet | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Conta KRBTGT fraca (Golden Ticket)]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Altera√ß√µes de permiss√µes padr√£o na parti√ß√£o do esquema]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: (Get-Acl 'AD:CN=Schema,CN=Configuration,DC=gruppen,DC=com,DC=br').Access | Where-Object {$_.IdentityReference -notmatch 'SYSTEM|Administrators|Schema Admins|Enterprise Admins'} | Select-Object Identit...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Altera√ß√µes de permiss√µes padr√£o na parti√ß√£o do esquema]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ Configura√ß√µes Cr√≠ticas: 0 achados
Oct 03 20:56:59 vlxsam99 npm[847716]: üë• Executando testes: Gerenciamento de Contas...
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Usu√°rios privilegiados com Service Principal Names (SPN) definidos]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Filter * -Properties servicePrincipalName, MemberOf | Where-Object {$_.servicePrincipalName -and ($_.MemberOf -match 'Admins')} | Select-Object Name, SamAccountName, servicePrincipalName |...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Usu√°rios privilegiados com Service Principal Names (SPN) definidos]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Contas com senha sem expira√ß√£o]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Filter {PasswordNeverExpires -eq $true} -Property Name, PasswordNeverExpires | Select-Object Name, PasswordNeverExpires | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas com senha sem expira√ß√£o]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Contas com pr√©-autentica√ß√£o desativada]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Filter * -Properties UserAccountControl | Where-Object {$_.UserAccountControl -band 0x400000} | Select-Object Name, SamAccountName | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas com pr√©-autentica√ß√£o desativada]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Conta de administrador padr√£o fraca]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Identity 'Administrator' -Property PasswordLastSet, PasswordNeverExpires, LastLogonTimestamp | Select-Object Name, PasswordLastSet, PasswordNeverExpires, @{Name='LastLogon';Expression={[Da...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Conta de administrador padr√£o fraca]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Controladores de dom√≠nio com senha n√£o alterada recentemente]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADDomainController -Filter * | ForEach-Object { Get-ADComputer -Identity $_.Name -Property PasswordLastSet | Select-Object Name, PasswordLastSet } | ConvertTo-Json...
Oct 03 20:56:59 vlxsam99 npm[847716]: ‚úÖ PowerShell [Controladores de dom√≠nio com senha n√£o alterada recentemente]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:56:59 vlxsam99 npm[847716]: üîß PowerShell [Contas com ID de grupo prim√°rio (PrimaryGroupID) menor que 1000]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:56:59 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:56:59 vlxsam99 npm[847716]: Get-ADUser -Filter {primaryGroupId -lt 1000} -Property primaryGroupId | Select-Object Name, primaryGroupId | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas com ID de grupo prim√°rio (PrimaryGroupID) menor que 1000]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Atributo AdminCount definido para usu√°rios padr√£o]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Filter {admincount -gt 0} -Properties adminCount, MemberOf | Where-Object {-not ($_.MemberOf -match "Admins")} | Select-Object Name, SamAccountName, adminCount | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Atributo AdminCount definido para usu√°rios padr√£o]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Rela√ß√µes de confian√ßa de alto risco]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADTrust -Filter * | Select-Object Name, TrustType, TrustDirection, ForestTransitive | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Rela√ß√µes de confian√ßa de alto risco]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Contas com SID privilegiado oculto]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Filter {admincount -gt 0} -Properties adminCount, sidHistory | Where-Object {$_.sidHistory} | Select-Object Name, SamAccountName, adminCount, sidHistory | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas com SID privilegiado oculto]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Contas usando controle de acesso compat√≠vel com pr√©-Windows 2000]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADGroupMember -Identity 'Pre-Windows 2000 Compatible Access' -Recursive | Select-Object Name, SamAccountName | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas usando controle de acesso compat√≠vel com pr√©-Windows 2000]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ Gerenciamento de Contas: 0 achados
Oct 03 20:57:00 vlxsam99 npm[847716]: üé´ Executando testes: Kerberos e Delega√ß√£o...
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Conta KRBTGT com delega√ß√£o restrita baseada em recursos (RBCD) habilitada]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Identity 'krbtgt' -Property 'msDS-AllowedToDelegateTo' | Select-Object SamAccountName, 'msDS-AllowedToDelegateTo' | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Conta KRBTGT com delega√ß√£o restrita baseada em recursos (RBCD) habilitada]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Usu√°rios padr√£o com permiss√£o para leitura de senha de GMSA]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADServiceAccount -Filter * -Properties PrincipalsAllowedToRetrieveManagedPassword | Where-Object {$_.PrincipalsAllowedToRetrieveManagedPassword} | Select-Object Name, PrincipalsAllowedToRetrieveMa...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Usu√°rios padr√£o com permiss√£o para leitura de senha de GMSA]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Avalia√ß√£o de vulnerabilidades do Kerberos]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Filter * -Properties 'msDS-SupportedEncryptionTypes' | Where-Object {$_.'msDS-SupportedEncryptionTypes' -lt 16} | Select-Object Name, SamAccountName, 'msDS-SupportedEncryptionTypes' | Conv...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Avalia√ß√£o de vulnerabilidades do Kerberos]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Comprometimento de conta de computador via delega√ß√£o restrita baseada em recursos do Kerberos (RBCD)]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADComputer -Filter * -Properties PrincipalsAllowedToDelegateToAccount | Where-Object {$_.PrincipalsAllowedToDelegateToAccount} | Select-Object Name, SamAccountName, PrincipalsAllowedToDelegateToAc...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Comprometimento de conta de computador via delega√ß√£o restrita baseada em recursos do Kerberos (RBCD)]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Direitos de acesso perigosos na conta KDC do RODC]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADDomainController -Filter {IsReadOnly -eq $true} | ForEach-Object { Get-ADComputer -Identity $_.Name -Properties 'msDS-RevealedUsers' | Select-Object Name, 'msDS-RevealedUsers' } | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Direitos de acesso perigosos na conta KDC do RODC]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ Kerberos e Delega√ß√£o: 0 achados
Oct 03 20:57:00 vlxsam99 npm[847716]: üìÇ Executando testes: Compartilhamentos e GPOs...
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Coleta de credenciais a partir de compartilhamentos de dom√≠nio]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: $paths = @('\\gruppen.com.br\SYSVOL', '\\gruppen.com.br\NETLOGON'); foreach ($path in $paths) { Get-ChildItem -Path $path -Recurse -Include *.ps1, *.vbs, *.bat, *.xml -ErrorAction SilentlyContinue | S...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Coleta de credenciais a partir de compartilhamentos de dom√≠nio]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Verificar objetos GPO sens√≠veis e permiss√µes de arquivos]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: $path = '\\gruppen.com.br\SYSVOL'; $acl = Get-Acl -Path $path; $acl.Access | Where-Object {$_.IdentityReference -notmatch 'Domain Admins|Enterprise Admins|SYSTEM|Administrators|Authenticated Users|Ser...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Verificar objetos GPO sens√≠veis e permiss√µes de arquivos]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Assinatura SMB fraca]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-SmbServerConfiguration | Select-Object RequireSecuritySignature, EnableSecuritySignature | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Assinatura SMB fraca]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ Compartilhamentos e GPOs: 0 achados
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚öôÔ∏è  Executando testes: Pol√≠ticas e Configura√ß√£o...
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Contas com par√¢metros de controle de conta de usu√°rio arriscados]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADUser -Filter * -Property userAccountControl | Where-Object {($_.userAccountControl -band 0x10000) -or ($_.userAccountControl -band 0x80000)} | Select-Object Name, userAccountControl | ConvertTo-...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas com par√¢metros de controle de conta de usu√°rio arriscados]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Dom√≠nios com n√≠vel funcional desatualizado]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADDomain | Select-Object DomainMode, DistinguishedName | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Dom√≠nios com n√≠vel funcional desatualizado]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Solu√ß√£o LAPS n√£o habilitada]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADComputer -Filter * -Properties 'ms-Mcs-AdmPwd' -ResultSetSize 100 | Where-Object {$_.'ms-Mcs-AdmPwd' -eq $null} | Measure-Object | Select-Object Count | ConvertTo-Json...
Oct 03 20:57:00 vlxsam99 npm[847716]: ‚úÖ PowerShell [Solu√ß√£o LAPS n√£o habilitada]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:00 vlxsam99 npm[847716]: üîß PowerShell [Contas de usu√°rio padr√£o como administradores DNS]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:00 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:00 vlxsam99 npm[847716]: Get-ADGroupMember -Identity 'DnsAdmins' -Recursive | Where-Object {$_.objectClass -eq 'user'} | Select-Object Name, SamAccountName | ConvertTo-Json...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas de usu√°rio padr√£o como administradores DNS]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [ACE n√£o can√¥nico em objetos]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $objects = Get-ADObject -Filter * -Properties nTSecurityDescriptor -ResultSetSize 1000; $nonCanonical = $objects | Where-Object {$_.nTSecurityDescriptor.AreAccessRulesCanonical -eq $false}; $nonCanoni...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [ACE n√£o can√¥nico em objetos]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [Contas krbtgt de RODC √≥rf√£s]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: Get-ADObject -Filter {(objectclass -eq 'user') -and (name -like 'krbtgt*')} -Properties 'msDS-KrbTgtLinkBl' | Where-Object {-not $_.'msDS-KrbTgtLinkBl'} | Select-Object Name, 'msDS-KrbTgtLinkBl' | Con...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas krbtgt de RODC √≥rf√£s]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [Dom√≠nio com configura√ß√£o de compatibilidade retroativa perigosa]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: Get-ADObject -Identity 'CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=gruppen,DC=com,DC=br' -Properties dSHeuristics | Where-Object {$_.dSHeuristics} | Select-Object -ExpandProper...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Dom√≠nio com configura√ß√£o de compatibilidade retroativa perigosa]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ Pol√≠ticas e Configura√ß√£o: 0 achados
Oct 03 20:57:01 vlxsam99 npm[847716]: üí§ Executando testes: Contas Inativas...
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [Contas privilegiadas inativas]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $DaysInactive = 90; $InactiveDate = (Get-Date).AddDays(-$DaysInactive); Get-ADUser -Filter {Enabled -eq $True} -Properties LastLogonDate, MemberOf | Where-Object {($_.LastLogonDate -lt $InactiveDate) ...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas privilegiadas inativas]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [Contas desativadas em grupos privilegiados]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: Get-ADUser -Filter {Enabled -eq $false} -Properties MemberOf | Where-Object {$_.MemberOf -match 'Admins'} | Select-Object Name, SamAccountName | ConvertTo-Json...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas desativadas em grupos privilegiados]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [Contas gMSA com senha n√£o alterada recentemente]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $DaysThreshold = 90; $ThresholdDate = (Get-Date).AddDays(-$DaysThreshold); Get-ADServiceAccount -Filter * -Properties whenChanged | Where-Object {$_.whenChanged -lt $ThresholdDate} | Select-Object Nam...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas gMSA com senha n√£o alterada recentemente]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [Contas de servi√ßo inativas h√° mais de 60 dias]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $daysInactive = 60; $limitDate = (Get-Date).AddDays(-$daysInactive); Get-ADUser -Filter {(servicePrincipalName -like '*') -and (LastLogonDate -lt $limitDate)} -Properties LastLogonDate, servicePrincip...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas de servi√ßo inativas h√° mais de 60 dias]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [Servidores com senhas n√£o alteradas h√° mais de 60 dias]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $days = 60; $limitDate = (Get-Date).AddDays(-$days); Get-ADComputer -Filter {OperatingSystem -like '*Windows Server*'} -Properties PasswordLastSet | Where-Object {$_.PasswordLastSet -lt $limitDate} | ...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Servidores com senhas n√£o alteradas h√° mais de 60 dias]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: üîß PowerShell [Contas de usu√°rio dormentes]: Executando comando via WinRM no DC 192.168.100.43
Oct 03 20:57:01 vlxsam99 npm[847716]: üìù Script:
Oct 03 20:57:01 vlxsam99 npm[847716]: $days = 90; $date = (Get-Date).AddDays(-$days); Get-ADUser -Filter {(Enabled -eq $true) -and (LastLogonDate -lt $date)} -Properties LastLogonDate -ResultSetSize 100 | Select-Object Name, LastLogonDate...
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ PowerShell [Contas de usu√°rio dormentes]: Conclu√≠do (exitCode: 1, stdout: 0 chars, stderr: 187 chars)
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ Contas Inativas: 0 achados
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ An√°lise conclu√≠da: 0 achados, 28 resultados de teste
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ Salvos 28 resultados de testes AD Security
Oct 03 20:57:01 vlxsam99 npm[847716]: üîç PROCESS_JOB_RESULTS: Starting with jobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: üîç PROCESS_JOB_RESULTS: Journey 3664d3b1-86ea-48c8-818b-04bb18cbe79f, Type: ad_security, JobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: üîç ThreatEngine.analyzeWithLifecycle: Analisando 0 findings para journeyType 'ad_security' (jobId: 554102b9-2a44-4f2a-821b-186726e14258)
Oct 03 20:57:01 vlxsam99 npm[847716]: üéØ ThreatEngine.analyzeWithLifecycle: Criou 0 amea√ßas de 0 findings para journeyType 'ad_security'
Oct 03 20:57:01 vlxsam99 npm[847716]: üîç PROCESS_JOB_RESULTS: About to run post-processing with jobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: üîç AD_SECURITY_CLOSURES: Starting with journeyId: 3664d3b1-86ea-48c8-818b-04bb18cbe79f, jobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: üìä AD_SECURITY_METRICS: Starting analysis - observedKeys: 0, openThreats: 0, currentJobId: 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: ‚úÖ AD_SECURITY_METRICS: Completed - skippedCurrentJob: 0, closed: 0, keptOpen: 0, noCorrelationKey: 0, total: 0
Oct 03 20:57:01 vlxsam99 npm[847716]: üîÑ Processing journey completion for job 554102b9-2a44-4f2a-821b-186726e14258
Oct 03 20:57:01 vlxsam99 npm[847716]: üÜï CLOSURE_METRICS: First-run detected for journey 3664d3b1-86ea-48c8-818b-04bb18cbe79f - skipping auto-closure (previousJobsCount: 0, currentJobId: 554102b9-2a44-4f2a-821b-186726e14258)
Oct 03 20:57:01 vlxsam99 npm[847716]: üóëÔ∏è  Job 554102b9-2a44-4f2a-821b-186726e14258 removido dos jobs em execu√ß√£o
Oct 03 20:57:12 vlxsam99 npm[847716]: 8:57:12 PM [express] GET /api/hosts 200 in 29ms :: [{"id":"f42626ab-42fc-4e99-aae6-463750535e9d","na‚Ä¶
Oct 03 20:57:14 vlxsam99 npm[847716]: 8:57:14 PM [express] GET /api/threats 200 in 6ms :: []
Oct 03 20:57:14 vlxsam99 npm[847716]: 8:57:14 PM [express] GET /api/hosts/f42626ab-42fc-4e99-aae6-463750535e9d/risk-history 200 in 7ms :: ‚Ä¶
Oct 03 20:57:14 vlxsam99 npm[847716]: 8:57:14 PM [express] GET /api/hosts/f42626ab-42fc-4e99-aae6-463750535e9d/ad-tests 200 in 20ms :: [{"‚Ä¶
